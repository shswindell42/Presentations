{
	"name": "Aggregate Queries",
	"properties": {
		"content": {
			"query": "select LEFT(loan_sequence_number, 5) as origination_quarter\n\t,case when credit_score >= 800 THEN '1 Exceptional'\n\t\twhen credit_score between 740 and 799 then '2 Very Good'\n\t\twhen credit_score between 670 and 739 then '3 Good'\n\t\twhen credit_score between 580 and 669 then '4 Fair'\n\t\twhen credit_score <= 579 then '5 Poor'\n\t\tend as credit_range\n\t,AVG(original_interest_rate) as average_interest_rate\n\t,count(*) as number_loans\nfrom loans\ngroup by case when credit_score >= 800 THEN '1 Exceptional'\n\t\twhen credit_score between 740 and 799 then '2 Very Good'\n\t\twhen credit_score between 670 and 739 then '3 Good'\n\t\twhen credit_score between 580 and 669 then '4 Fair'\n\t\twhen credit_score <= 579 then '5 Poor'\n\t\tend\n\t,LEFT(loan_sequence_number, 5)\norder by origination_quarter\n\t,credit_range\n\n-- percentage of delinquent loans\nselect LEFT(l.loan_sequence_number, 5) as origination_quarter\n\t,case when credit_score >= 800 THEN '1 Exceptional'\n\t\twhen credit_score between 740 and 799 then '2 Very Good'\n\t\twhen credit_score between 670 and 739 then '3 Good'\n\t\twhen credit_score between 580 and 669 then '4 Fair'\n\t\twhen credit_score <= 579 then '5 Poor'\n\t\tend as credit_range\n\t,sum(case when lp.current_loan_delinquency_status in ('XX', '0', '   ') then 0 else 1 end) as number_delinquent_loans\n\t,count(distinct l.loan_sequence_number) as number_loans\n\t,sum(case when lp.current_loan_delinquency_status in ('XX', '0', '   ') then 0 else 1 end) / count(distinct l.loan_sequence_number) as percentage_delinquent_loans\nfrom loans l\n\tinner join [dbo].[loan_performance] lp\n\t\ton l.loan_sequence_number = lp.loan_sequence_number\ngroup by case when credit_score >= 800 THEN '1 Exceptional'\n\t\twhen credit_score between 740 and 799 then '2 Very Good'\n\t\twhen credit_score between 670 and 739 then '3 Good'\n\t\twhen credit_score between 580 and 669 then '4 Fair'\n\t\twhen credit_score <= 579 then '5 Poor'\n\t\tend\n\t,LEFT(l.loan_sequence_number, 5)\norder by origination_quarter\n\t,credit_range",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}